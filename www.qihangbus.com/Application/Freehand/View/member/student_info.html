<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <meta name="keywords" content="admin, dashboard, bootstrap, template, flat, modern, theme, responsive, fluid, retina, backend, html5, css, css3">
  <meta name="description" content="">
  <meta name="author" content="ThemeBucket">
  <link rel="shortcut icon" href="#" type="image/png">
  <title>学生信息_{:L('_WEBSITE_NAME_')}</title>
  <link href="__PUBLIC__/js/advanced-datatable/css/demo_page.css" rel="stylesheet" />
  <link href="__PUBLIC__/js/advanced-datatable/css/demo_table.css" rel="stylesheet" />
  <link rel="stylesheet" href="__PUBLIC__/js/data-tables/DT_bootstrap.css" />

  <link href="__PUBLIC__/css/style.css" rel="stylesheet">
  <link href="__PUBLIC__/css/style-responsive.css" rel="stylesheet">

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="__PUBLIC__/js/html5shiv.js"></script>
  <script src="__PUBLIC__/js/respond.min.js"></script>
  <![endif]-->
</head>

<body class="sticky-header">

<section>
    <!-- left side start-->
    <div class="left-side sticky-left-side">

        <!--logo and iconic logo start-->
        <div class="logo">
            <a href="./"><img src="__PUBLIC__/images/logo.png" alt=""></a>
        </div>

        <div class="logo-icon text-center">
            <a href="./"><img src="__PUBLIC__/images/logo_icon.png" alt=""></a>
        </div>
        <!--logo and iconic logo end-->

        <div class="left-side-inner">

            <!-- visible to small devices only -->
            <div class="visible-xs hidden-sm hidden-md hidden-lg">
                <div class="media logged-user">
                    <img alt="" src="__PUBLIC__/images/photos/user-avatar.png" class="media-object">
                    <div class="media-body">
                        <h4><a href="#">John Doe</a></h4>
                        <span>"Hello There..."</span>
                    </div>
                </div>

                <h5 class="left-nav-title">Account Information</h5>
                <ul class="nav nav-pills nav-stacked custom-nav">
                  <li><a href="#"><i class="fa fa-user"></i> <span>Profile</span></a></li>
                  <li><a href="#"><i class="fa fa-cog"></i> <span>Settings</span></a></li>
                  <li><a href="#"><i class="fa fa-sign-out"></i> <span>Sign Out</span></a></li>
                </ul>
            </div>

            <include file="common:menu"/>

        </div>
    </div>
    <!-- left side end-->
    
    <!-- main content start-->
    <div class="main-content" >

        <include file="common:header"/>

        <!-- page heading start-->
        <div class="page-heading">
            <h3>
                <if condition="$info.student_id gt 0">修改<else/>添加</if>学生信息
            </h3>
            <ul class="breadcrumb">
                <li>
                    <a href="#">后台首页</a>
                </li>
                <li>
                    <a href="#">系统设置</a>
                </li>
            </ul>
        </div>
        <!-- page heading end-->

        <!--body wrapper start-->
        <style type="text/css">
            .col-lg-4{color:#65cea7}
            .col-lg-4 label{color:#cccccc}
        </style>
        <div class="wrapper">
            <div class="row">





                        <div class="col-lg-12">
                            <section class="panel">
                    

                                <header class="panel-heading">
                                    
                                    <if condition="$info.student_id gt 0">修改<else/>添加</if>学生信息
                                    <span class="pull-right">
                                        <a href="{:U('/Student/index')}" class="btn btn-primary">学生列表</a>
                                        <a href="javascript:void(0);" class="btn disabled">添加学生</a>
                                        <a href="{:U('/Student/import')}" class="btn btn-primary">导入数据</a>
                                     </span>
                                </header>

                                <div class="panel-body">
                                    <form class="form-horizontal" method="post" name="myform" action="{:U('/Student/edit_handle')}" role="form">
                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">所属机构</label>
                                            <div class="col-lg-4">
                                                <select name="school_id" id="school_id" onchange="change_grade();" class="form-control m-bot15">
                                                    <volist name="school" id="vo">
                                                        <option value="{$vo['school_id']}" <eq name="info.school_id" value="$vo.school_id">selected</eq>>{$vo['school_name']}</option>
                                                    </volist>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">所属年级</label>
                                            <div class="col-lg-4">
                                                <select name="grade_id" id="grade_id" onchange="change_class()" class="form-control m-bot15">
                                                    <volist name="grade" id="vo">
                                                        <option value="{$vo['grade_id']}" <eq name="info.grade_id" value="$vo.grade_id">selected</eq>>{$vo['grade_name']}</option>
                                                    </volist>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">所属班级</label>
                                            <div class="col-lg-4">
                                                <select name="class_id" id="class_id" onchange="change_teacher()" class="form-control m-bot15">
                                                    <volist name="class" id="vo">
                                                        <option value="{$vo['class_id']}" <eq name="info.class_id" value="$vo.class_id">selected</eq>>{$vo['class_name']}</option>
                                                    </volist>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">所属分组</label>
                                            <div class="col-lg-4">
                                                <select name="groupid" id="groupid" class="form-control m-bot15">
                                                    <volist name="group" id="vo">
                                                        <option value="0">请选择</option>
                                                        <option value="{$vo['id']}" <eq name="info.groupid" value="$vo.id">selected</eq>>{$vo['name']}</option>
                                                    </volist>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">责任老师</label>
                                            <div class="col-lg-4">
                                                <select name="teacher_id" id="teacher_id" class="form-control m-bot15">
                                                    <volist name="teacher" id="vo">
                                                        <option value="{$vo['teacher_id']}" <eq name="info.teacher_id" value="$vo.teacher_id">selected</eq>>{$vo['teacher_name']}</option>
                                                    </volist>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">学生名称</label>
                                            <div class="col-lg-3">
                                                <input type="text" class="form-control" name="student_name" value="{$info.student_name}">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">学籍库学号</label>
                                            <div class="col-lg-3">
                                                <input type="text" class="form-control" name="school_sn" value="{$info.school_sn}">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">自定义学号</label>
                                            <div class="col-lg-3">
                                                <input type="text" class="form-control" name="student_sn" value="{$info.student_sn}">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">家长姓名</label>
                                            <div class="col-lg-3">
                                                <input type="hidden" name="parent_id" value="{$parent.parent_id}">
                                                <input type="hidden" name="parent_sex" value="{$parent.parent_sex}">
                                                <input type="text" class="form-control" name="parent_name" value="{$parent.parent_name}">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-lg-2 col-sm-2 control-label">联系方式</label>
                                            <div class="col-lg-3">
                                                <input type="text" class="form-control" name="parent_mobile" value="{$parent.parent_mobile}">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-lg-offset-1 col-lg-10">
                                                <input type="hidden" name="student_id" value="{$info.student_id}"/>
                                                <input type="submit" class="btn btn-primary" value="提交"/>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </section>

                        </div>


            </div>
        </div>
        <!--body wrapper end-->
        <include file="common:footer"/>
    </div>
    <!-- main content end-->
</section>
<!-- Placed js at the end of the document so the pages load faster -->
<script src="__PUBLIC__/js/jquery-1.10.2.min.js"></script>
<script src="__PUBLIC__/js/jquery-ui-1.9.2.custom.min.js"></script>
<script src="__PUBLIC__/js/jquery-migrate-1.2.1.min.js"></script>
<script src="__PUBLIC__/js/bootstrap.min.js"></script>
<script src="__PUBLIC__/js/modernizr.min.js"></script>
<script src="__PUBLIC__/js/jquery.nicescroll.js"></script>
<!--easy pie chart-->
<script src="__PUBLIC__/js/easypiechart/jquery.easypiechart.js"></script>
<script src="__PUBLIC__/js/easypiechart/easypiechart-init.js"></script>
<!--Sparkline Chart-->
<script src="__PUBLIC__/js/sparkline/jquery.sparkline.js"></script>
<script src="__PUBLIC__/js/sparkline/sparkline-init.js"></script>
<!--icheck -->
<script src="__PUBLIC__/js/iCheck/jquery.icheck.js"></script>
<script src="__PUBLIC__/js/icheck-init.js"></script>
<!-- jQuery Flot Chart-->
<script src="__PUBLIC__/js/flot-chart/jquery.flot.js"></script>
<script src="__PUBLIC__/js/flot-chart/jquery.flot.tooltip.js"></script>
<script src="__PUBLIC__/js/flot-chart/jquery.flot.resize.js"></script>
<!--Morris Chart-->
<script src="__PUBLIC__/js/morris-chart/morris.js"></script>
<script src="__PUBLIC__/js/morris-chart/raphael-min.js"></script>
<!--Calendar-->
<script src="__PUBLIC__/js/calendar/clndr.js"></script>
<script src="__PUBLIC__/js/calendar/evnt.calendar.init.js"></script>
<script src="__PUBLIC__/js/calendar/moment-2.2.1.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
<!--common scripts for all pages-->
<script src="__PUBLIC__/js/scripts.js"></script>
<!--Dashboard Charts-->
<script src="__PUBLIC__/js/dashboard-chart-init.js"></script>
<script>
    function change_grade(){
        var sid = $('#school_id').val();
        $.ajax({
            type:'post',
            url:"{:U('/Student/ajax_grade')}",
            data:{school_id:sid},
            dataType:'json',
            success:function(data){
                var arr = '';
                arr += "<option>请选择</option>";
                for(var i=0;i<data.length;i++){
                    arr += "<option value='"+data[i]['grade_id']+"'>"+data[i]['grade_name']+"</option>";
                }
                $('#grade_id').html(arr);
                $('#class_id').html("<option>请选择</option>");
                $('#teacher_id').html("<option>请选择</option>");
            }
        });
    }

    function change_class(){
        var gid = $('#grade_id').val();
        $.ajax({
            type:'post',
            url:"{:U('/Student/ajax_class')}",
            data:{grade_id:gid},
            dataType:'json',
            success:function(data){
                var arr = '';
                arr += "<option>请选择</option>";
                for(var i=0;i<data.length;i++){
                    arr += "<option value='"+data[i]['class_id']+"'>"+data[i]['class_name']+"</option>";
                }
                $('#class_id').html(arr);
                $('#teacher_id').html("<option>请选择</option>");
            }
        });
    }

    function change_teacher(){
        var cid = $('#class_id').val();
        $.ajax({
            type:'post',
            url:"{:U('/Student/ajaxTeacherNew')}",
            data:{class_id:cid},
            dataType:'json',
            success:function(data){
                var arr = '';
                arr += "<option>请选择</option>";
                var teacher = data.teacher;
                for(var i=0;i<teacher.length;i++){
                    arr += "<option value='"+teacher[i]['teacher_id']+"'>"+teacher[i]['teacher_name']+"</option>";
                }
                $('#teacher_id').html(arr);
                arr = "<option value='0' selected>请选择</option>";
                var group = data.group;
                group.forEach(function(e){
                    arr += "<option value='"+ e.id +"'>"+ e.name +"</option>";
                });
                $('#groupid').html(arr);
            }
        });
    }
</script>
</body>
</html>
